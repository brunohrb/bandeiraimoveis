<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Bandeira's Imobiliaria Gest√£o Financeira ‚Ä¢ 2026</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="cdnjs.cloudflare.com">
  
  <style>
.card-full {
  max-width: 100% !important;
}
        :root{ --bg:#f8fafc; --primary:#1e3a8a; --border:#e2e8f0; }
        body{ font-family: 'Inter', sans-serif; background:var(--bg); color:#1e293b; }
        .sidebar{ background:#0f172a; min-height:100vh; width:260px; position:fixed; color:white; padding:20px; }
        .main{ margin-left: 260px; padding:40px; }
.card{
  background:white;
  border-radius:16px;
  padding:16px 16px 14px;
  border:1px solid var(--border);

  box-shadow:0 8px 28px rgba(0,0,0,0.06);

  width:100%;
  max-width:420px;

  max-height:calc(100vh - 40px);
  overflow-y:auto;
}
        .modal{ display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); backdrop-filter:blur(4px); z-index:100; align-items:center; justify-content:center; }
       .btn{
  padding:8px 14px;              /* ‚¨ÖÔ∏è bot√£o mais baixo */
  border-radius:10px;
  font-weight:600;               /* ‚¨ÖÔ∏è menos ‚Äúgritado‚Äù */
  font-size:14px;

  cursor:pointer;
  transition:all .2s ease;
  border:none;

  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
}

.btn-primary{
  background:var(--primary);
  color:white;
}

.btn-ghost{
  background:#f8fafc;
  color:#475569;
}

        .tag{ padding:4px 8px; border-radius:6px; font-size:11px; font-weight:800; text-transform:uppercase; display: inline-block;}
        .tag-free{ background:#dcfce7; color:#166534; }
        .tag-late{ background:#fee2e2; color:#991b1b; }
        .tag-occupied{ background:#e0f2fe; color:#0369a1; }
        .input{ width:100%; padding:12px; border:1px solid var(--border); border-radius:8px; margin-top:4px; outline:none; }
        .payment-month { cursor: pointer; transition: transform 0.2s; }
        .payment-month:hover { transform: scale(1.05); }
label{
  font-size:12px;
  font-weight:600;
  color:#475569;
  letter-spacing:.02em;
}
.input{
  padding:10px 12px;
  font-size:14px;
  border-radius:10px;
}
@media (max-width: 640px){

  .card{
    max-width:94%;
    padding:14px;
    border-radius:18px;
  }

  .btn{
    width:100%;
  }

  .grid{
    grid-template-columns:1fr !important;
  }
}
@media (max-width:640px){
  .btn{
    width:100%;
  }
}

    </style>
</head>
<body>

<div class="sidebar">
    <!-- NOVO DESIGN DA MARCA -->
    <div class="mb-10 p-2 bg-blue-900 rounded-lg shadow-xl">
        <h2 class="text-xl font-extrabold italic text-center">Bandeira's</h2>
        <p class="text-xs text-center font-medium text-blue-300">Gest√£o Financeira</p>
    </div>
    <nav class="space-y-2">
<div
  onclick="voltarParaPortfolio()"
  class="p-3 bg-slate-800 rounded-lg cursor-pointer flex items-center gap-3 hover:bg-slate-700">
  <i class="fas fa-home"></i> Portf√≥lio 2026
</div>
<div onclick="abrirFinanceiro()"
     class="p-3 bg-slate-800 rounded-lg cursor-pointer flex items-center gap-3 hover:bg-slate-700">
  üìä Financeiro
</div>

        <div onclick="localStorage.clear(); location.reload();" class="p-3 text-slate-400 hover:text-white cursor-pointer flex items-center gap-3 mt-10"><i class="fas fa-trash"></i> Resetar Sistema</div>
    </nav>
</div>

<div class="main">
<!-- VIEW FINANCEIRO -->
<div id="viewFinanceiro" class="hidden">

  <h1 class="text-3xl font-black mb-6">
    DASHBOARD FINANCEIRO ‚Ä¢ 2026
  </h1>

<!-- FILTROS -->
<div class="flex gap-4 mb-8 flex-wrap">

  <select id="filtroMes" class="input w-40">
    <option value="all">Todos os meses</option>
    <option value="0">Janeiro</option>
    <option value="1">Fevereiro</option>
    <option value="2">Mar√ßo</option>
    <option value="3">Abril</option>
    <option value="4">Maio</option>
    <option value="5">Junho</option>
    <option value="6">Julho</option>
    <option value="7">Agosto</option>
    <option value="8">Setembro</option>
    <option value="9">Outubro</option>
    <option value="10">Novembro</option>
    <option value="11">Dezembro</option>
  </select>

  <select id="filtroAno" class="input w-32">
    <option value="2026">2026</option>
  </select>

  <select id="filtroPredio" class="input w-64">
    <option value="all">Todos os pr√©dios</option>
  </select>

  <button class="btn btn-primary" onclick="aplicarFiltros()">
    Aplicar filtros
  </button>

<button class="btn btn-primary" onclick="abrirModalDespesa()">
  ‚ûï Nova despesa
</button>


</div>


<!-- LINHA 1: LISTA + CARD GRANDE -->
<!-- LINHA 2: CARDS RESUMO -->
<!-- CARDS DO DASHBOARD -->
<div class="grid grid-cols-3 gap-4 mb-10">

  <div class="card">
    <p class="text-xs uppercase text-slate-400">Contas a Receber</p>
    <p id="finReceber" class="text-2xl font-black text-blue-700">R$ 0,00</p>
  </div>

  <div class="card">
    <p class="text-xs uppercase text-slate-400">Alugu√©is Recebidos</p>
    <p id="finAluguelRecebido" class="text-2xl font-black text-green-700">R$ 0,00</p>
  </div>

  <div class="card">
    <p class="text-xs uppercase text-slate-400">Juros / Multas</p>
    <p id="finJuros" class="text-2xl font-black text-amber-600">R$ 0,00</p>
  </div>

  <div class="card">
    <p class="text-xs uppercase text-slate-400">Inadimpl√™ncia</p>
    <p id="finInadimplencia" class="text-2xl font-black text-red-600">R$ 0,00</p>
  </div>

  <div class="card">
    <p class="text-xs uppercase text-slate-400">Cau√ß√µes (saldo)</p>
    <p id="finCaucao" class="text-2xl font-black text-purple-700">R$ 0,00</p>
  </div>

  <div class="card">
    <p class="text-xs uppercase text-slate-400">Contas a Pagar</p>
    <p id="finPagar" class="text-2xl font-black text-slate-700">R$ 0,00</p>
  </div>

<div class="card">
  <p class="text-xs uppercase text-slate-400">Lucro</p>
  <p id="finLucro" class="text-2xl font-black text-emerald-700">
    R$ 0,00
  </p>
</div>


  <!-- CONSOLIDADO EMBAIXO, LARGO -->

</div>

<!-- LISTA CONTAS A PAGAR (EMBAIXO DE TUDO) -->
<div class="card card-full mt-10">

  <div class="flex justify-between items-center mb-4">
    <h2 class="text-lg font-black">Contas a pagar</h2>
    <span class="text-xs text-slate-400 uppercase">Detalhamento</span>
  </div>

  <div class="max-h-80 overflow-y-auto border rounded-lg">
    <table class="w-full text-sm">
     <thead class="bg-slate-50 text-slate-500 uppercase text-xs sticky top-0">
  <tr>
    <th class="p-3 text-left">Descri√ß√£o</th>
    <th class="p-3 text-left">Pr√©dio</th>
    <th class="p-3 text-left">Categoria</th>
    <th class="p-3 text-left">Data</th>
    <th class="p-3 text-right">Valor</th>
<th class="p-3 text-center">A√ß√µes</th>

  </tr>
</thead>

      <tbody id="listaDespesas"></tbody>
    </table>
  </div>

</div>

</div>


<div id="viewPortfolio">
    <header class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-3xl font-black text-slate-900 tracking-tight">GEST√ÉO FINANCEIRA</h1>
            <p class="text-slate-500">Controle de pr√©dios e inquilinos. Data Atual: 06/01/2026</p>
        </div>
        <button class="btn btn-primary" onclick="openModal('modalPredio')"><i class="fas fa-plus"></i> NOVO PR√âDIO</button>
    </header>
<div id="gridPredios" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
</div>

<!-- MODAL NOVO PREDIO -->
<div id="modalPredio" class="modal">
    <div class="card w-[450px]">
        <h3 class="font-black text-xl mb-6">CADASTRAR PR√âDIO</h3>
        <label class="text-xs font-bold text-slate-400 uppercase">Nome do Condom√≠nio</label>
        <input id="pNome" class="input mb-4" placeholder="Ex: Edif√≠cio Mar Azul">
        <label class="text-xs font-bold text-slate-400 uppercase">Unidades (Separe por v√≠rgula)</label>
        <textarea id="pUnidades" class="input h-24 mb-6" placeholder="Apto 101, Apto 102, Cobertura..."></textarea>
        <div class="flex gap-2">
            <button class="btn btn-primary flex-1 justify-center" onclick="addPredio()">CRIAR PR√âDIO</button>
            <button class="btn btn-ghost" onclick="closeModal('modalPredio')"><i class="fas fa-arrow-left"></i> VOLTAR</button>
        </div>
    </div>
</div>

<!-- MODAL LISTA INQUILINOS (DETALHE DO PR√âDIO) -->
<div id="modalDetalhe" class="modal">
    <div class="card w-[90%] max-w-5xl max-h-[80vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 id="detalheTitulo" class="font-black text-2xl uppercase italic"></h3>
            <button class="btn btn-ghost" onclick="closeModal('modalDetalhe')"><i class="fas fa-times"></i> FECHAR</button>
        </div>
        <table class="w-full text-left">
            <thead class="text-xs text-slate-400 uppercase border-b">
                <tr>
                    <th class="pb-3">Unidade</th>
                    <th class="pb-3">Inquilino</th>
                    <th class="pb-3">Valor</th>
                    <th class="pb-3">Venc.</th>
                    <th class="pb-3">Status</th>
<th class="pb-3">Financeiro</th>
                    <th class="pb-3">Contrato</th>
                    <th class="pb-3 text-right">A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="listaUnidades"></tbody>
        </table>
    </div>
</div>

<!-- MODAL EDITAR/CADASTRAR INQUILINO E PAGAMENTOS -->
<div id="modalInquilino" class="modal">
    <div class="card w-[450px]">
        <h3 id="inqTitulo" class="font-black text-xl mb-6 uppercase">GERIR INQUILINO</h3>
        <input type="hidden" id="inqUnidadeId">
        <input type="hidden" id="inqPredioId">
        <div class="space-y-4">
            <div>
                <label class="text-xs font-bold">Nome Completo</label>
<input id="inqNome" class="input mb-3">

<div class="grid grid-cols-2 gap-3 mb-3">
  <div>
    <label class="text-xs font-bold">Nacionalidade</label>
    <input id="inqNacionalidade" class="input">
  </div>
  <div>
    <label class="text-xs font-bold">Profiss√£o</label>
    <input id="inqProfissao" class="input">
  </div>
</div>

<label class="text-xs font-bold">Identidade (RG)</label>
<input id="inqRG" class="input mb-3">

<label class="text-xs font-bold">CPF</label>
<input id="inqCPF" class="input mb-3">

<label class="text-xs font-bold">Telefone / WhatsApp</label>
<input id="inqTelefone" class="input mb-3" placeholder="(85) 9xxxx-xxxx">

<label class="text-xs font-bold">Endere√ßo Completo</label>
<textarea id="inqEndereco" class="input mb-3"></textarea>

<label class="text-xs font-bold">Cau√ß√£o (R$)</label>
<input id="inqCaucao" class="input mb-3">

<div class="grid grid-cols-2 gap-3 mb-3">
  <div>
    <label class="text-xs font-bold">Aluguel (R$)</label>
    <input id="inqValor" class="input" placeholder="Ex: 1.350,00">
  </div>
  <div>
    <label class="text-xs font-bold">Dia de vencimento</label>
    <input id="inqVenc" type="number" min="1" max="31" class="input">
  </div>
</div>

                <label class="text-xs font-bold text-slate-400 uppercase">Anexo do Contrato (.pdf/imagem)</label>
                <input id="inqArquivo" type="file" class="text-xs mt-2 block w-full text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                <div id="viewContrato" class="mt-2 hidden"><a href="#" target="_blank" class="text-blue-600 font-bold text-xs underline uppercase tracking-widest"><i class="fas fa-file-pdf"></i> Visualizar Atual</a></div>
            </div>
            <div class="flex gap-2 pt-4">
<button class="btn btn-ghost w-full mb-2" onclick="gerarContratoPDF()">
    üìÑ Gerar contrato (PDF)
</button>
                <button class="btn btn-primary flex-1 justify-center" onclick="saveInquilino()">SALVAR DADOS</button>
                <button id="btnVacar" class="btn btn-ghost text-red-600" onclick="vacarUnidade()">REMOVER</button>
                <button class="btn btn-ghost" onclick="closeModal('modalInquilino')"><i class="fas fa-arrow-left"></i> VOLTAR</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL PAGAMENTOS -->
<div id="modalPagamentos" class="modal">
    <div class="card w-[450px]">
        <div class="flex justify-between items-center mb-6">
            <h3 id="pagamentosTitulo" class="font-black text-xl uppercase">Hist√≥rico 2026</h3>
            <button class="btn btn-ghost" onclick="closeModalPagamentos()"><i class="fas fa-times"></i> FECHAR</button>
        </div>



<button
  class="btn btn-primary w-full mb-4"
  onclick="avisarInquilinoAutomatico(findInquilinoById(currentInquilinoId))">
  üì≤ Avisar inquilino pelo WhatsApp
</button>



        <input type="hidden" id="pagInqId">
        <div id="gridPagamentos" class="grid grid-cols-4 gap-4">
            <!-- Renderizado via JS -->
        </div>
    </div>
</div>

<!-- MODAL BAIXA DE PAGAMENTO -->
<div id="modalBaixaPagamento" class="modal">
  <div class="card w-[380px]">
    
    <div class="flex justify-between items-center mb-4">
      <h3 id="baixaTitulo" class="font-black text-lg uppercase">
        Baixa de Pagamento
      </h3>
      <button class="btn btn-ghost" onclick="closeModal('modalBaixaPagamento')">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <p id="baixaSubtitulo" class="text-xs text-slate-500 mb-4">
      <!-- Inquilino / Unidade -->
    </p>

    <div class="space-y-3">

      <div>
     <label class="text-xs font-bold">Aluguel pago (R$)</label>
<input
  id="bpAluguel"
  type="number"
  step="0.01"
  class="input"
  oninput="atualizarTotalBaixa()">


      </div>

      <div>
        <label class="text-xs font-bold">Juros / Multa (R$)</label>
<input
  id="bpJuros"
  type="number"
  step="0.01"
  class="input"
  value="0"
  oninput="atualizarTotalBaixa()">


      </div>

      <div>
        <label class="text-xs font-bold">Data do pagamento</label>
        <input id="bpData" type="date" class="input">
      </div>

      <div class="bg-slate-50 p-3 rounded-lg border text-center">
        <p class="text-xs text-slate-400 uppercase font-bold">Total recebido</p>
        <p id="bpTotal" class="text-xl font-black text-slate-800">R$ 0,00</p>
      </div>

    </div>

    <div class="flex gap-2 mt-6">
     <button
  class="btn btn-primary flex-1 justify-center"
  onclick="confirmarPagamento()">
  Confirmar pagamento
</button>

      <button class="btn btn-ghost" onclick="closeModal('modalBaixaPagamento')">
        Cancelar
      </button>
    </div>

  </div>
</div>


<script>

<script>
    // ========================================================================
    // 1. CONFIGURA√á√ÉO DO SUPABASE
    // ========================================================================
    const SUPABASE_URL = 'COLE_SUA_URL_AQUI'; // Exemplo: https://seu-projeto.supabase.co
    const SUPABASE_KEY = 'COLE_SUA_CHAVE_ANON_PUBLIC_AQUI'; // Exemplo: eyJhbGc...

    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY );

    // ========================================================================
    // 2. VARI√ÅVEIS GLOBAIS E CONSTANTES
    // ========================================================================
    let db = { predios: [], lancamentos: [] };
    let currentBase64 = "";
    let currentViewingPredioId = null;
    let currentInquilino = null;
    let currentUnidade = null;
    const MESES = ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"];
    const HOJE = new Date();

    // ========================================================================
    // 3. FUN√á√ïES PRINCIPAIS DE DADOS (AGORA COM SUPABASE)
    // ========================================================================

    async function carregarDadosIniciais() {
        console.log("Carregando dados do Supabase...");
        if (document.getElementById('loadingOverlay')) {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        const { data: prediosData, error: prediosError } = await supabase
            .from('predios')
            .select(`*, unidades (*)`)
            .order('created_at', { ascending: true });

        if (prediosError) {
            console.error('Erro ao buscar pr√©dios:', prediosError);
            alert('N√£o foi poss√≠vel carregar os dados dos pr√©dios.');
            if (document.getElementById('loadingOverlay')) {
                document.getElementById('loadingOverlay').style.display = 'none';
            }
            return;
        }

        const { data: lancamentosData, error: lancamentosError } = await supabase
            .from('lancamentos')
            .select('*');

        if (lancamentosError) {
            console.error('Erro ao buscar lan√ßamentos:', lancamentosError);
            alert('N√£o foi poss√≠vel carregar os dados financeiros.');
            if (document.getElementById('loadingOverlay')) {
                document.getElementById('loadingOverlay').style.display = 'none';
            }
            return;
        }

        db.predios = prediosData;
        db.lancamentos = lancamentosData;

        console.log("Dados carregados:", db);
        render();
        if (document.getElementById('loadingOverlay')) {
            document.getElementById('loadingOverlay').style.display = 'none';
        }
    }

    async function addPredio() {
        const nome = document.getElementById('pNome').value;
        const unidadesTxt = document.getElementById('pUnidades').value;
        if (!nome || !unidadesTxt) return alert("Preencha o nome e as unidades do pr√©dio.");

        const { data: predioData, error: predioError } = await supabase
            .from('predios')
            .insert({ nome: nome })
            .select()
            .single();

        if (predioError) {
            console.error('Erro ao criar pr√©dio:', predioError);
            return alert('Falha ao criar o pr√©dio.');
        }

        const unidadesParaInserir = unidadesTxt.split(',').map(u => ({
            nome: u.trim(),
            predio_id: predioData.id,
            status: 'vago',
            inquilino: null
        }));

        const { error: unidadesError } = await supabase
            .from('unidades')
            .insert(unidadesParaInserir);

        if (unidadesError) {
            console.error('Erro ao criar unidades:', unidadesError);
            return alert('Pr√©dio criado, mas falha ao adicionar unidades.');
        }

        document.getElementById('pNome').value = '';
        document.getElementById('pUnidades').value = '';
        closeModal('modalPredio');
        carregarDadosIniciais();
    }

    async function saveInquilino() {
        const unidadeId = document.getElementById('inqUnidadeId').value;
        const predioId = document.getElementById('inqPredioId').value;

        if (!currentUnidade) {
            alert("Erro: Nenhuma unidade selecionada para salvar o inquilino.");
            return;
        }

        const inquilinoData = {
            id: currentUnidade.inquilino?.id || Math.random().toString(36).substr(2, 9),
            nome: document.getElementById('inqNome').value,
            telefone: document.getElementById('inqTelefone').value,
            valor: document.getElementById('inqValor').value,
            venc: document.getElementById('inqVenc').value,
            caucao: parseFloat(document.getElementById('inqCaucao').value) || 0,
            contrato: currentBase64 || currentUnidade.inquilino?.contrato || "",
            pagamentos: currentUnidade.inquilino?.pagamentos || Array.from({ length: 12 }, () => ({ pago: false })),
            nacionalidade: document.getElementById('inqNacionalidade').value,
            profissao: document.getElementById('inqProfissao').value,
            rg: document.getElementById('inqRG').value,
            cpf: document.getElementById('inqCPF').value,
            endereco: document.getElementById('inqEndereco').value,
        };

        const { error } = await supabase
            .from('unidades')
            .update({ inquilino: inquilinoData, status: 'ocupado' })
            .eq('id', unidadeId);

        if (error) {
            console.error("Erro ao salvar inquilino:", error);
            return alert("Falha ao salvar os dados do inquilino.");
        }

        const caucaoValor = inquilinoData.caucao;
        if (caucaoValor > 0) {
            const jaExisteCaucao = db.lancamentos.some(l =>
                l.categoria === 'caucao' &&
                l.observacao.includes(inquilinoData.nome) &&
                l.observacao.includes(currentUnidade.nome)
            );

            if (!jaExisteCaucao) {
                await supabase.from('lancamentos').insert({
                    tipo: 'receita',
                    categoria: 'caucao',
                    valor: caucaoValor,
                    data: new Date().toISOString().split('T')[0],
                    predio_id: predioId,
                    observacao: `Cau√ß√£o de ${inquilinoData.nome} - Unidade ${currentUnidade.nome}`
                });
            }
        }

        closeModal('modalInquilino');
        carregarDadosIniciais();
    }

    async function vacarUnidade() {
        if (!confirm("Remover inquilino desta unidade?")) return;
        const unidadeId = document.getElementById('inqUnidadeId').value;

        const { error } = await supabase
            .from('unidades')
            .update({ inquilino: null, status: 'vago' })
            .eq('id', unidadeId);

        if (error) {
            console.error("Erro ao desocupar unidade:", error);
            return alert("Falha ao remover inquilino.");
        }

        closeModal('modalInquilino');
        carregarDadosIniciais();
    }

    async function confirmarPagamento() {
        const mes = window.mesBaixaAtual;
        const aluguel = parseFloat(document.getElementById('bpAluguel').value) || 0;
        const juros = parseFloat(document.getElementById('bpJuros').value) || 0;
        const data = document.getElementById('bpData').value || new Date().toISOString().split('T')[0];

        currentInquilino.pagamentos[mes] = {
            pago: true,
            aluguel: aluguel,
            juros: juros,
            data: data
        };

        const { error: updateError } = await supabase
            .from('unidades')
            .update({ inquilino: currentInquilino })
            .eq('id', currentUnidade.id);

        if (updateError) {
            console.error("Erro ao atualizar pagamento:", updateError);
            alert("Falha ao salvar o pagamento.");
            currentInquilino.pagamentos[mes] = { pago: false };
            return;
        }

        const lancamentosParaInserir = [];
        lancamentosParaInserir.push({
            tipo: 'receita',
            categoria: 'aluguel',
            valor: aluguel,
            data: data,
            predio_id: currentUnidade.predio_id,
            observacao: `Aluguel de ${currentInquilino.nome} - M√™s: ${MESES[mes]}`
        });

        if (juros > 0) {
            lancamentosParaInserir.push({
                tipo: 'receita',
                categoria: 'juros',
                valor: juros,
                data: data,
                predio_id: currentUnidade.predio_id,
                observacao: `Juros/Multa de ${currentInquilino.nome} - M√™s: ${MESES[mes]}`
            });
        }

        const { error: lancamentoError } = await supabase.from('lancamentos').insert(lancamentosParaInserir);
        if (lancamentoError) {
            console.error("Erro ao criar lan√ßamentos financeiros:", lancamentoError);
            alert("Pagamento salvo, mas houve um erro ao registrar no financeiro.");
        }

        closeModal('modalBaixaPagamento');
        renderPagamentosGrid(currentInquilino);
        carregarDadosIniciais();
    }

    async function reverterPagamento(mesIndex) {
        const mesNome = MESES[mesIndex];
        if (!confirm(`Deseja reverter o pagamento de ${mesNome}? Esta a√ß√£o n√£o pode ser desfeita.`)) return;

        const pagamentoOriginal = currentInquilino.pagamentos[mesIndex];
        currentInquilino.pagamentos[mesIndex] = { pago: false };

        const { error: updateError } = await supabase
            .from('unidades')
            .update({ inquilino: currentInquilino })
            .eq('id', currentUnidade.id);

        if (updateError) {
            console.error("Erro ao reverter pagamento (update):", updateError);
            alert("Falha ao reverter o pagamento.");
            currentInquilino.pagamentos[mesIndex] = pagamentoOriginal;
            return;
        }

        const obsAluguel = `Aluguel de ${currentInquilino.nome} - M√™s: ${mesNome}`;
        const obsJuros = `Juros/Multa de ${currentInquilino.nome} - M√™s: ${mesNome}`;

        await supabase.from('lancamentos').delete().eq('observacao', obsAluguel);
        if (pagamentoOriginal.juros > 0) {
            await supabase.from('lancamentos').delete().eq('observacao', obsJuros);
        }

        renderPagamentosGrid(currentInquilino);
        carregarDadosIniciais();
    }

    async function salvarDespesa() {
        const descricao = document.getElementById('despDescricao').value;
        const categoria = document.getElementById('despCategoria').value;
        const valor = parseFloat(document.getElementById('despValor').value);
        const data = document.getElementById('despData').value;
        const predioId = document.getElementById('despPredio').value || null;

        if (!descricao || !valor || !data) {
            return alert("Preencha descri√ß√£o, valor e data.");
        }

        const lancamento = {
            tipo: 'despesa',
            categoria: categoria,
            valor: valor,
            data: data,
            predio_id: predioId,
            observacao: descricao
        };

        let error;
        if (window.despesaEditandoId) {
            const { error: updateError } = await supabase
                .from('lancamentos')
                .update(lancamento)
                .eq('id', window.despesaEditandoId);
            error = updateError;
        } else {
            const { error: insertError } = await supabase
                .from('lancamentos')
                .insert(lancamento);
            error = insertError;
        }

        if (error) {
            console.error("Erro ao salvar despesa:", error);
            return alert("Falha ao salvar a despesa.");
        }

        window.despesaEditandoId = null;
        closeModal('modalDespesa');
        carregarDadosIniciais();
    }

    async function excluirDespesa(id) {
        if (!confirm("Deseja realmente excluir esta despesa?")) return;

        const { error } = await supabase
            .from('lancamentos')
            .delete()
            .eq('id', id);

        if (error) {
            console.error("Erro ao excluir despesa:", error);
            return alert("Falha ao excluir a despesa.");
        }
        carregarDadosIniciais();
    }

    async function removerPredio(predioId) {
        const p = db.predios.find(x => x.id === predioId);
        if (!p) return;

        if (!confirm(`Tem certeza que deseja excluir o pr√©dio "${p.nome}"?\n\n‚ö†Ô∏è Isso ir√° remover TODAS as unidades e inquilinos deste pr√©dio de forma permanente.`)) return;

        const { error } = await supabase.from('predios').delete().eq('id', predioId);

        if (error) {
            console.error("Erro ao remover pr√©dio:", error);
            return alert("Falha ao remover o pr√©dio. Verifique se h√° lan√ßamentos financeiros ligados a ele e tente novamente.");
        }
        carregarDadosIniciais();
    }

    // ========================================================================
    // 4. FUN√á√ïES DE RENDERIZA√á√ÉO E UI
    // ========================================================================

    function render() {
        if (!db || !db.predios) return;
        const grid = document.getElementById('gridPredios');
        grid.innerHTML = db.predios.map(p => {
            const livres = p.unidades.filter(u => u.status === 'vago').length;
            const ocupados = p.unidades.length - livres;
            let inadimplentesCount = 0;
            p.unidades.forEach(u => {
                if (u.inquilino) {
                    const mesAtual = HOJE.getMonth();
                    const diaVenc = parseInt(u.inquilino.venc);
                    const pagamentoMes = u.inquilino.pagamentos[mesAtual];
                    if ((!pagamentoMes || !pagamentoMes.pago) && HOJE.getDate() > diaVenc) {
                        inadimplentesCount++;
                    }
                }
            });

            return `
            <div class="card relative cursor-pointer hover:shadow-xl transition" onclick="viewPredio(${p.id})">
                <div class="absolute top-2 right-2 flex gap-1">
                    <button onclick="event.stopPropagation(); removerPredio(${p.id})" class="text-slate-400 hover:text-red-600 text-xs p-1" title="Apagar pr√©dio">üóëÔ∏è</button>
                </div>
                <div class="flex justify-between items-start mb-6">
                    <h3 class="text-lg font-black text-slate-800 uppercase tracking-tight">${p.nome}</h3>
                    <span class="text-[10px] bg-slate-100 text-slate-500 font-bold px-2 py-1 rounded">${p.unidades.length} UNID.</span>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-blue-50 p-3 rounded-lg border border-blue-100">
                        <p class="text-[10px] font-bold text-blue-400 uppercase">Livres</p>
                        <p class="text-2xl font-black text-blue-900">${livres}</p>
                    </div>
                    <div class="bg-amber-50 p-3 rounded-lg border border-amber-100">
                        <p class="text-[10px] font-bold text-amber-400 uppercase">Inadimplentes</p>
                        <p class="text-2xl font-black text-amber-900">${inadimplentesCount}</p>
                    </div>
                </div>
                <div class="mt-6 flex items-center justify-between text-xs font-bold text-slate-400 uppercase">
                    <span>Ocupa√ß√£o: ${p.unidades.length > 0 ? ((ocupados / p.unidades.length) * 100).toFixed(0) : 0}%</span>
                    <i class="fas fa-arrow-right text-blue-600"></i>
                </div>
            </div>`;
        }).join('');

        if (document.getElementById('viewFinanceiro') && document.getElementById('viewFinanceiro').style.display !== 'none') {
            aplicarFiltros();
        }
    }

    function viewPredio(predioId) {
        currentViewingPredioId = predioId;
        const p = db.predios.find(x => x.id === predioId);
        if (!p) return;

        document.getElementById('detalheTitulo').innerText = p.nome;
        const lista = document.getElementById('listaUnidades');
        lista.innerHTML = p.unidades.sort((a, b) => a.nome.localeCompare(b.nome)).map(u => {
            const statusTag = u.status === 'vago' ? '<span class="tag tag-free">Vago</span>' : '<span class="tag tag-occupied">Ocupado</span>';
            let financeiroTag = '<span class="text-slate-300">‚Äî</span>';

            if (u.status === 'ocupado' && u.inquilino) {
                const mesAtual = HOJE.getMonth();
                const diaVenc = parseInt(u.inquilino.venc);
                const pagamentoMes = u.inquilino.pagamentos[mesAtual];

                if (pagamentoMes && pagamentoMes.pago) {
                    financeiroTag = '<span class="tag tag-free">Pago</span>';
                } else if (HOJE.getDate() > diaVenc) {
                    financeiroTag = '<span class="tag tag-late">Inadimplente</span>';
                }
            }

            const contratoBtn = u.inquilino && u.inquilino.contrato ? `<a href="${u.inquilino.contrato}" target="_blank" class="text-blue-600 hover:underline font-semibold"><i class="fas fa-file-pdf"></i> Ver Contrato</a>` : '-';
            const inquilinoNome = u.inquilino ? `<span class="cursor-pointer text-blue-700 hover:underline font-medium" onclick="viewPagamentos(${p.id}, ${u.id})">${u.inquilino.nome}</span>` : '<span class="text-slate-300 italic">Dispon√≠vel</span>';

            return `
                <tr class="border-b hover:bg-slate-50 transition text-sm">
                    <td class="py-4 font-bold text-slate-800">${u.nome}</td>
                    <td>${inquilinoNome}</td>
                    <td>${u.inquilino ? 'R$ ' + parseFloat(u.inquilino.valor).toLocaleString('pt-BR') : '-'}</td>
                    <td>${u.inquilino ? 'Dia ' + u.inquilino.venc : '-'}</td>
                    <td class="text-center">${statusTag}</td>
                    <td class="text-center">${financeiroTag}</td>
                    <td>${contratoBtn}</td>
                    <td class="text-right">
                        <button onclick="editInquilino(${p.id}, ${u.id})" class="text-blue-600 font-black text-xs uppercase hover:underline">
                            <i class="fas fa-edit"></i> ${u.inquilino ? 'Editar' : 'Alugar'}
                        </button>
                    </td>
                </tr>`;
        }).join('');
        openModal('modalDetalhe');
    }

    function editInquilino(predioId, unidadeId) {
        const p = db.predios.find(x => x.id === predioId);
        const u = p.unidades.find(x => x.id === unidadeId);
        currentUnidade = u;

        document.getElementById('viewContrato').classList.add('hidden');
        document.getElementById('viewContrato').querySelector('a').href = '#';
        document.getElementById('inqArquivo').value = '';

        document.getElementById('inqPredioId').value = predioId;
        document.getElementById('inqUnidadeId').value = unidadeId;
        document.getElementById('inqTitulo').innerText = u.nome;

        if (u.inquilino) {
            const i = u.inquilino;
            document.getElementById('inqNome').value = i.nome || '';
            document.getElementById('inqValor').value = i.valor || '';
            document.getElementById('inqVenc').value = i.venc || '';
            document.getElementById('inqCaucao').value = i.caucao || 0;
            document.getElementById('inqNacionalidade').value = i.nacionalidade || '';
            document.getElementById('inqProfissao').value = i.profissao || '';
            document.getElementById('inqRG').value = i.rg || '';
            document.getElementById('inqCPF').value = i.cpf || '';
            document.getElementById('inqTelefone').value = i.telefone || '';
            document.getElementById('inqEndereco').value = i.endereco || '';
            document.getElementById('btnVacar').style.display = 'block';
            if (i.contrato) {
                document.getElementById('viewContrato').classList.remove('hidden');
                document.getElementById('viewContrato').querySelector('a').href = i.contrato;
            }
        } else {
            ['inqNome', 'inqValor', 'inqVenc', 'inqCaucao', 'inqNacionalidade', 'inqProfissao', 'inqRG', 'inqCPF', 'inqTelefone', 'inqEndereco'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('btnVacar').style.display = 'none';
        }
        openModal('modalInquilino');
    }

    function viewPagamentos(predioId, unidadeId) {
        const p = db.predios.find(x => x.id === predioId);
        const u = p.unidades.find(x => x.id === unidadeId);
        if (!u || !u.inquilino) return;

        currentUnidade = u;
        currentInquilino = u.inquilino;

        document.getElementById('pagamentosTitulo').innerText = `Hist√≥rico de ${currentInquilino.nome.split(' ')[0]}`;
        renderPagamentosGrid(currentInquilino);
        openModal('modalPagamentos');
    }

    function renderPagamentosGrid(inq) {
        const grid = document.getElementById('gridPagamentos');
        grid.innerHTML = (inq.pagamentos || []).map((pag, index) => {
            const mesNome = MESES[index];
            const pago = pag && pag.pago;
            return `
            <div class="payment-month p-3 text-center rounded-lg shadow-sm ${pago ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700'}" onclick="handlePagamentoClick(${index})">
                <p class="font-bold">${mesNome}</p>
                <p class="text-xs">${pago ? 'Pago' : 'Pendente'}</p>
            </div>`;
        }).join('');
    }

    function handlePagamentoClick(mesIndex) {
        const pago = currentInquilino.pagamentos[mesIndex] && currentInquilino.pagamentos[mesIndex].pago;
        if (pago) {
            reverterPagamento(mesIndex);
        } else {
            abrirBaixaPagamento(mesIndex);
        }
    }

    function abrirBaixaPagamento(mesIndex) {
        window.mesBaixaAtual = mesIndex;
        document.getElementById('bpAluguel').value = currentInquilino.valor || 0;
        document.getElementById('bpJuros').value = 0;
        document.getElementById('bpData').value = new Date().toISOString().split('T')[0];
        document.getElementById('baixaSubtitulo').innerText = `${MESES[mesIndex]} ‚Ä¢ ${currentInquilino.nome}`;
        atualizarTotalBaixa();
        openModal('modalBaixaPagamento');
    }

    function renderDespesas() {
        const { mes, ano, predio } = getFiltrosFinanceiro();
        const tbody = document.getElementById('listaDespesas');
        if (!tbody) return;

        const despesasFiltradas = db.lancamentos.filter(l => {
            if (l.tipo !== 'despesa') return false;
            const dataLancamento = new Date(l.data);
            if (mes !== 'all' && dataLancamento.getMonth() != mes) return false;
            if (ano && dataLancamento.getFullYear() != ano) return false;
            if (predio !== 'all' && l.predio_id != predio) return false;
            return true;
        });

        tbody.innerHTML = despesasFiltradas.map(d => {
            const predioNome = d.predio_id ? (db.predios.find(p => p.id == d.predio_id)?.nome || '‚Äî') : 'Geral';
            return `
            <tr class="border-b hover:bg-slate-50">
                <td class="p-3">${d.observacao || '-'}</td>
                <td class="p-3 font-medium">${predioNome}</td>
                <td class="p-3 capitalize">${d.categoria}</td>
                <td class="p-3">${new Date(d.data).toLocaleDateString('pt-BR', { timeZone: 'UTC' })}</td>
                <td class="p-3 text-right font-bold text-red-600">R$ ${parseFloat(d.valor).toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</td>
                <td class="p-3 text-center whitespace-nowrap">
                    <button onclick="editarDespesa(${d.id})" class="text-blue-600 hover:text-blue-800 mr-2" title="Editar">‚úèÔ∏è</button>
                    <button onclick="excluirDespesa(${d.id})" class="text-red-600 hover:text-red-800" title="Excluir">üóëÔ∏è</button>
                </td>
            </tr>`;
        }).join('');
    }

    function editarDespesa(id) {
        const d = db.lancamentos.find(l => l.id === id);
        if (!d) return;

        document.getElementById('despDescricao').value = d.observacao || '';
        document.getElementById('despCategoria').value = d.categoria;
        document.getElementById('despValor').value = d.valor;
        document.getElementById('despData').value = d.data;
        document.getElementById('despPredio').value = d.predio_id || '';

        window.despesaEditandoId = id;
        abrirModalDespesa();
    }

    // ========================================================================
    // 5. FUN√á√ïES AUXILIARES E DE UI
    // ========================================================================

    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModal(id) {
        document.getElementById(id).style.display = 'none';
        currentBase64 = "";
    }
    function closeModalPagamentos() {
        closeModal('modalPagamentos');
    }
    
    if (document.getElementById('inqArquivo')) {
        document.getElementById('inqArquivo').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onloadend = () => currentBase64 = reader.result;
            reader.readAsDataURL(file);
        });
    }
    
    function montarContratoTexto() {
        const p = db.predios.find(x => x.id == document.getElementById('inqPredioId').value);
        const u = p.unidades.find(x => x.id == document.getElementById('inqUnidadeId').value);
        const i = {
            nome: document.getElementById('inqNome').value,
            nacionalidade: document.getElementById('inqNacionalidade').value,
            profissao: document.getElementById('inqProfissao').value,
            rg: document.getElementById('inqRG').value,
            cpf: document.getElementById('inqCPF').value,
            endereco: document.getElementById('inqEndereco').value,
            valor: document.getElementById('inqValor').value,
            venc: document.getElementById('inqVenc').value,
            caucao: document.getElementById('inqCaucao').value
        };

        return `CONTRATO DE LOCA√á√ÉO RESIDENCIAL\n\nLOCADOR: [SEU NOME/NOME DA EMPRESA], com sede em [SEU ENDERE√áO], doravante denominado LOCADOR.\n\nLOCAT√ÅRIO(A): ${i.nome.toUpperCase()}, ${i.nacionalidade}, ${i.profissao}, portador(a) do RG n¬∫ ${i.rg} e do CPF n¬∫ ${i.cpf}, residente e domiciliado(a) em ${i.endereco}.\n\nIM√ìVEL: A unidade ${u.nome}, localizada no pr√©dio ${p.nome}.\n\nCL√ÅUSULA 1¬™ - O valor do aluguel mensal √© de R$ ${parseFloat(i.valor).toLocaleString('pt-BR', {minimumFractionDigits: 2})}.\n\nCL√ÅUSULA 2¬™ - O aluguel dever√° ser pago at√© o dia ${i.venc} de cada m√™s.\n\nCL√ÅUSULA 3¬™ - O locat√°rio deposita neste ato o valor de R$ ${parseFloat(i.caucao).toLocaleString('pt-BR', {minimumFractionDigits: 2})} a t√≠tulo de cau√ß√£o.\n\nE, por estarem assim justos e contratados, assinam o presente contrato em duas vias de igual teor.\n\n[SUA CIDADE], ${new Date().toLocaleDateString('pt-BR')}.\n\n_________________________\nLOCADOR\n\n_________________________\nLOCAT√ÅRIO(A): ${i.nome.toUpperCase()}`;
    }
    
    function gerarContratoPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const texto = montarContratoTexto();
        doc.text(texto, 10, 10);
        doc.save('contrato.pdf');
    }
    
    function atualizarTotalBaixa() {
        const aluguel = parseFloat(document.getElementById('bpAluguel').value) || 0;
        const juros = parseFloat(document.getElementById('bpJuros').value) || 0;
        document.getElementById('bpTotal').innerText = `R$ ${(aluguel + juros).toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
    }
    
    function getFiltrosFinanceiro() { 
        return { 
            mes: document.getElementById('filtroMes').value, 
            ano: document.getElementById('filtroAno').value, 
            predio: document.getElementById('filtroPredio').value 
        }; 
    }
    
    function calcularFinanceiro() {
        const { mes, ano, predio } = getFiltrosFinanceiro();
        let alugueisRecebidos = 0, jurosRecebidos = 0, caucaoSaldo = 0, contasPagar = 0, inadimplencia = 0, lucro = 0;

        db.lancamentos.forEach(l => {
            if (l.categoria === 'caucao') {
                caucaoSaldo += parseFloat(l.valor);
            }
        });

        const lancamentosFiltrados = db.lancamentos.filter(l => {
            const dataLancamento = new Date(l.data);
            const noFiltroMes = mes === 'all';
            const noFiltroAno = !ano;
            const noFiltroPredio = predio === 'all';

            const mesOk = noFiltroMes || dataLancamento.getMonth() == mes;
            const anoOk = noFiltroAno || dataLancamento.getFullYear() == ano;
            const predioOk = noFiltroPredio || l.predio_id == predio;

            return mesOk && anoOk && predioOk;
        });

        lancamentosFiltrados.forEach(l => {
            if (l.tipo === 'receita') {
                if (l.categoria === 'aluguel') alugueisRecebidos += parseFloat(l.valor);
                if (l.categoria === 'juros') jurosRecebidos += parseFloat(l.valor);
            } else if (l.tipo === 'despesa') {
                contasPagar += parseFloat(l.valor);
            }
        });

        const mesAtual = HOJE.getMonth();
        db.predios.forEach(p => {
            p.unidades.forEach(u => {
                if (u.inquilino) {
                    const diaVenc = parseInt(u.inquilino.venc);
                    const pagamentoMes = u.inquilino.pagamentos[mesAtual];
                    if (pagamentoMes && !pagamentoMes.pago && HOJE.getDate() > diaVenc) {
                        inadimplencia += parseFloat(u.inquilino.valor);
                    }
                }
            });
        });

        lucro = (alugueisRecebidos + jurosRecebidos) - contasPagar;

        if (document.getElementById('finAlugueis')) document.getElementById('finAlugueis').innerText = `R$ ${alugueisRecebidos.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        if (document.getElementById('finJuros')) document.getElementById('finJuros').innerText = `R$ ${jurosRecebidos.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        if (document.getElementById('finCaucao')) document.getElementById('finCaucao').innerText = `R$ ${caucaoSaldo.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        if (document.getElementById('finDespesas')) document.getElementById('finDespesas').innerText = `R$ ${contasPagar.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        if (document.getElementById('finInadimplencia')) document.getElementById('finInadimplencia').innerText = `R$ ${inadimplencia.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        if (document.getElementById('finLucro')) document.getElementById('finLucro').innerText = `R$ ${lucro.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
    }
    
    function aplicarFiltros() {
        renderDespesas();
        calcularFinanceiro();
    }
    
    function setupFiltros() {
        const anoAtual = HOJE.getFullYear();
        const filtroAno = document.getElementById('filtroAno');
        for (let i = 0; i < 5; i++) {
            filtroAno.innerHTML += `<option value="${anoAtual - i}">${anoAtual - i}</option>`;
        }

        const filtroPredio = document.getElementById('filtroPredio');
        filtroPredio.innerHTML = '<option value="all">Todos os Pr√©dios</option>';
        db.predios.forEach(p => {
            filtroPredio.innerHTML += `<option value="${p.id}">${p.nome}</option>`;
        });

        const despPredio = document.getElementById('despPredio');
        despPredio.innerHTML = '<option value="">Geral / Sem V√≠nculo</option>';
        db.predios.forEach(p => {
            despPredio.innerHTML += `<option value="${p.id}">${p.nome}</option>`;
        });
    }
    
    function abrirModalDespesa() {
        document.getElementById('despForm').reset();
        window.despesaEditandoId = null;
        openModal('modalDespesa');
    }
    
    function showView(viewId) {
        ['viewDashboard', 'viewFinanceiro'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = 'none';
        });
        const viewEl = document.getElementById(viewId);
        if (viewEl) {
            viewEl.style.display = 'block';
            if (viewId === 'viewFinanceiro') {
                setupFiltros();
                aplicarFiltros();
            }
        }
    }

    // ========================================================================
    // 6. INICIALIZA√á√ÉO
    // ========================================================================
    document.addEventListener('DOMContentLoaded', carregarDadosIniciais);
</script>


<!-- MODAL NOVA DESPESA -->
<div id="modalDespesa" class="modal">
  <div class="card w-[420px]">
    <div class="flex justify-between items-center mb-4">
      <h3 class="font-black text-lg uppercase">Nova despesa</h3>
      <button class="btn btn-ghost" onclick="closeModal('modalDespesa')">‚úï</button>
    </div>

    <div class="space-y-4">

      <div>
        <label>Descri√ß√£o</label>
        <input id="despDescricao" class="input" placeholder="Ex: Limpeza do pr√©dio">
      </div>

      <div>
        <label>Categoria</label>
        <select id="despCategoria" class="input">
          <option value="manutencao">Manuten√ß√£o</option>
          <option value="limpeza">Limpeza</option>
          <option value="energia">Energia</option>
          <option value="agua">√Ågua</option>
          <option value="impostos">Impostos</option>
          <option value="outros">Outros</option>
        </select>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <div>
          <label>Valor (R$)</label>
          <input id="despValor" type="number" step="0.01" class="input" placeholder="0,00">
        </div>

        <div>
          <label>Data</label>
          <input id="despData" type="date" class="input">
        </div>
      </div>

      <div>
        <label>Fornecedor</label>
        <input id="despFornecedor" class="input" placeholder="Nome do fornecedor">
      </div>

      <div>
        <label>Pr√©dio (opcional)</label>
        <select id="despPredio" class="input">
          <option value="">Selecione um pr√©dio</option>
        </select>
      </div>

    </div>

    <div class="flex gap-2 mt-6">
      <button class="btn btn-primary flex-1" onclick="salvarDespesa()">‚úî Salvar</button>
      <button class="btn btn-ghost" onclick="closeModal('modalDespesa')">Cancelar</button>
    </div>
  </div>
</div>

</body>
</html>


